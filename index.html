<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
  
    <script>

		
      $(document).ready(function(){
        var $body = $('body');
        $body.html('');
        
        var index = 0;
        
        $("<h1>twittler <span id='news-feed'>news feed</span></h1>").prependTo($body);
        
        function formattedTime(time) {
        	var timeArray = time.toString().split(" ");
        	var date = timeArray.slice(0,4).join(" ");
        	var formatted = timeArray[4].split(":").slice(0,2);
        	var morningAfternoon = formatted[0] >= 12 ? "pm" : "am";        		
        	if(formatted[0] > 12) {formatted[0] -=12};
        	return "On " + date + " at " + formatted.join(":") + morningAfternoon;		
        };
        
        function userTimelineFilter(a,b,c) {
        	$(a).toggle();
        	$(b).toggle();
        	$(c).toggle();
        	$(".new-tweet").toggle();
        	$("#to-main").toggle();
        };
        	
        function loadTweets() {
        	while(index < streams.home.length){
          		var tweet = streams.home[index];
          		var $tweet = $('<div class='+tweet.user+'></div>');
          		var formatted = formattedTime(tweet.created_at);
          		$tweet.text(': ' + tweet.message);
          		$('<span class="timestamp">'+formatted+'</span>').appendTo($tweet);
          		$('<a href="#" class="userName-'+tweet.user+'">@'+tweet.user+'</a>').prependTo($tweet);
          		$tweet.insertAfter("h1");
          		index += 1;
        	} 
        };
        
        function applyStyle() {
        	$("div").css({'font-family': 'Tahoma, Geneva, sans-serif', 'margin': '10px', 'border':
        	'1px solid black','padding':'5px', 'border-radius':'5px'});	
          	$(".timestamp").css({'float':'right', 'font-size': '12px'});
        };
        
        loadTweets();
        applyStyle();
        
        $("<button class='new-tweet'>New Tweets</button>").appendTo($body);
        
        $("<p id='to-main'>Click username to return to main news feed</p>").appendTo($body);
        
        $(".userName-mracus").on("click", function() {
        	userTimelineFilter(".shawndrost", ".sharksforcheap", ".douglascalhoun");
        });
        
        $(".userName-shawndrost").on("click", function() {
        	userTimelineFilter(".mracus", ".sharksforcheap", ".douglascalhoun");
        });
        
        $(".userName-sharksforcheap").on("click", function() {
        	userTimelineFilter(".mracus", ".shawndrost", ".douglascalhoun");
        });
        
        $(".userName-douglascalhoun").on("click", function() {
        	userTimelineFilter(".mracus", ".shawndrost", ".sharksforcheap");
        });
        
        $("button").css({'color': 'white', 'background-color': '#4169E1',
        'border-radius': '5px', 'font-family': 'Tahoma, Geneva, sans-serif', 'margin':'10px',
        'height': '30px', 'width': '120px', 'font-size': '16px'});
        
        $("h1").css({'display': 'inline','color': 'white', 'background-color': '#4169E1',
        'padding':'3px 0 3px 5px','border-radius':'5px', 'margin': '10px'});
        
        $("#news-feed").css({'display': 'inline','color': '#4169E1', 'background-color': 'white',
        'padding':'3px 0 3px 5px'});
        
        $("#to-main").css({'display':'none', 'font-family': 'Tahoma, Geneva, sans-serif',
        'margin': '10px', 'font-size': '12px'});
        
        $(".new-tweet").on("click", function() {
        	loadTweets();
        	applyStyle();
        });
        
      });

    </script>
  </body>
</html>
